Parmi les différents CMS, Drupal fait partie de ceux les plus utilisés. De part cette popularité, celui-ci est aussi un des plus vulnérables. De nombreuses preuves de concepts sont même librement disponibles ! Mais que choisir et surtout comment mettre en œuvre ces dernières ? Avant toute exploitation, il est intéressant d'effectuer une première reconnaissance. L'enjeu est de pouvoir trouver des informations sur ce site. Il est notamment utile de connaitre :  
* la version du CMS qui est installé  
* les plugins et leurs versions  
* d'éventuels fichiers uploadés par l'administrateurs  

Pour cela il faudra apprendre à connaitre la structure de ce CMS (savoir dans quel dossier se situe quoi et surtout si ces derniers sont librement énumérables). 

Il peut aussi être utile de regarder le code source des pages à la recherches de mentions de copyright indiquant des versions ou à minima des mois / années de création qui pourront vous aiguiller sur cette dernière au travers d'une prise d'information sur la roadmap du produit (quelle version a été mis en ligne à quelle date). Certains modules de framework d'énumération ou d'exploitation (ex: metasploit) peuvent aussi vous faire gagner du temps afin de chercher des vulnérabilités

Certains dossiers sur le serveur peuvent aussi présenter un intérêt pour connaitre des informations utiles :  
* un éventuel dossier. git  
* des fichiers tels que README / CHANGELOG / LICENCE testés tels quels ou avec les extensions les plus communes (.md / .txt)  
* le fichier robots.txt à la racine (notamment pour trouver des directives Disallow qui masqueraient certains répertoires aux moteurs de recherches)  

Enfin (et ce n'est pas applicable ici), quand il s'agit d'un site en ligne, une reconnaissance avec les moteurs de recherche peut parfois s'avérer très intéressante (notamment avec les préfixes site: / inurl: / allinurl: ...)

Une fois ces informations récupérées, il n'y a plus qu'a chercher des vulnérabilités connues (par exemple via exploit-db) sur le CMS en lui-même ou sur les plugins et voir si les versions énumérées disposent de preuves de concept exploitables. Un tour sur metasploit pourrait aussi permettre de tester rapidement quelques vulnérabilités bien connues et rendre plus simple la phase d'exploitation.  

Vous trouverez dans le dossier des solutions les commandes que j'ai réalisé pour l'exploitation de ce CMS.